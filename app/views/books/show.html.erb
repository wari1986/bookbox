<div class="container my-12 mx-auto px-4 md:px-12 bg-white">

  <div class="first">

    <div class="flex mt-16 mb-8 shadow">

      <%# <div class="info w-1/4 text-lg bg-white mr-8">
        <%# <button class="flex justify-center m-8 px-8 py-2 rounded text-white bold bg-indigo-400 mx-auto" id="create_button"><%=link_to "Add a Book", new_book_path %>
        <%# </button>
        <div class=" h-full p-12 bg-gray-100 rounded">
          <h1 class='text-2xl my-4'>Your Profile</h1>
          <ul>
            <li>Your swaps</li>
            <li>Books in the bookshelf</li>
            <li>Books in the BookBox</li>
          </ul>
        </div>
      </div> %>

      <div class="info w-full py-4 px-32">
        <div class=''>
          <div class="flex mb-8">

            <div class='w-3/5 px-12'>
              <h1 class="text-4xl my-2"><%=@book.title %></h1>
              <h5 class="text-gray-500 my-2"><%=@book.author %></h5>
              <p class='text-justify my-8'><%= @book.description.truncate_words(160) %></p>
              <div class='grid grid-cols-4 my-4 w-1/2'>
                <h5 class='text-gray-500 m-2'><%= @book.category %></h5>
                <h5 class='text-gray-500 m-2'><%= @book.year %></h5>
                <h5 class='text-gray-500 m-2'><%= @book.language.upcase %></h5>
                <h5 class='text-gray-500 m-2'><%= @book.condition %></h5>
                <% @user_book_relationship = UserBookRelationship.find_by(book: @book, user: current_user, owned: true)%>
                  <% unless @user_book_relationship %>
                    <h5 class='text-gray-500 m-2'><%= @distance %> km</h5>
                  <% else %>
                    <%= link_to " ðŸ—‘ ",
                                        book_path(@book),
                                        method: :delete,
                                        data: { confirm: "Are you sure ?" } %>
                    <%= link_to "Edit a book", book_path,
                                        method: "patch"%>
                <% end %>
              </div>

              <div class="w-1/2 flex justify-start">
                <% unless @user_book_relationship %>
                  <button class="bg-indigo-400 text-white mr-8 py-3 px-8 rounded"><%=link_to "Get this book!", new_book_swap_path(@book) %></button>
                <% end %>
              </div>

            </div>

            <div class='w-2/5 flex justify-end align-middle my-auto'>
              <img class='w-80 object-fit rounded-lg' src="<%=@book.cover %>" alt="">
            </div>

          </div>
      </div>
    </div>
  </div>

    <div class='mx-auto my-8 p-8 h-48 bg-gray-100 text-center rounded-lg shadow'>
      <h3 class='text-3xl'>Previous owners</h3>
      <div class='my-12 flex justify-center'>
        <% if @previous_owners.empty? && @user_book_relationship %>
          <h4 class='text-xl'>Congrats! you are the first owner of this book.<br /> Start swapping with others to create a chain!</h4>
          <% elsif @previous_owners.empty? && @user_book_relationship == nil%>
            <h4>Be the first to swap this book and start the chain!</h4>
          <% else @previous_owners.each do |previous_owner| %>
            <img class="h-16 w-16 rounded-full" src="<%= previous_owner.profile_picture %>"alt="">
            <%# add other information on the user %>
            <%# add distance travelled by the book between each owner %>
          <% end %>
        <% end %>
      </div>
    </div>
    <div class='flex'>
      <div class='w-1/2 bg-gray-100'>
        <h2 class='text-3xl py-8 text-center'>Leave a review!</h2>
        <div class=" m-16 ">
          <div class="w-full">
            <%= simple_form_for(@review, url: book_reviews_path(@book), method: :post ) do |f| %>
              <%= f.input :title, input_html: {class:'shadow appearance-none border rounded w-full py-2 px-3 text-gray-700'} %>
              <%= f.input :content, input_html: {class:'shadow appearance-none border rounded w-full py-2 px-3 text-gray-700'}%>
              <%= f.input :stars, input_html: {class:'shadow appearance-none border rounded w-full py-2 px-3 text-gray-700'} %>
              <div class="w-1/3 bg-indigo-400 my-8 mx-auto"><%= f.button :submit, class:'bg-indigo-400 hover:bg-indigo-300 shadow appearance-none border rounded w-full py-2 px-3 text-white font-bold' %></div>
            <% end %>
          </div>
        </div>

      </div>
      <div class='w-1/2 mx-8 bg-gray-100'>
        <h2 class='text-3xl text-center py-8'>Reviews</h2>
        <% @book.reviews.take(2).each do |review|%>
        <div class='mx-24 my-8 rounded-lg '>
          <h1 class='bg-gray-400 text-xl py-2 px-4 rounded-lg'><%= review.title %></h1>
          <p class='bg-gray-300 py-8 px-4 rounded-lg'><%= review.content %></p>
          <p class='py-2 px-4 bg-gray-200 rounded-lg'><%= review.stars %></p>
        </div>
        <% end  %>
        </div>
      </div>
    </div>
  </div>
  <div id="map"
     style="width: 100%; height: 300px;"
     data-markers="<%= @markers.to_json %>"
     data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
  </div>
</div>
